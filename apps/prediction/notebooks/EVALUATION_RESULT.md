# モデル評価結果

## 実行日時
2025-11-26 10:43:41 ～

## データ
- **学習データ**: 231,472件（1,464レース）
- **検証データ**: 291,434件（1,990レース）
- **評価用データ**: 522,906件（evaluation_schema.jsonに基づいて選択済み）

## 特徴量
- **元の特徴量数**: 142
- **特徴量強化後**: 184（レース内相対特徴量 + インタラクション特徴量）

## 評価結果

### NDCG（Normalized Discounted Cumulative Gain）
- **NDCG@1**: 0.4072
- **NDCG@2**: 0.4073
- **NDCG@3**: 0.4073

### 的中率
- **1着的中率**: 25.38% (505/1,990レース)
- **3着内的中率**: 54.57% (1,086/1,990レース)

### 回収率
- **単勝回収率**: 78.36%
- **投資額**: 199,000円（1,990レース × 100円）
- **回収額**: 155,930円
- **損益**: -43,070円

### WIN5評価
- **WIN5的中率**: 0.00% (0/0日)
- **WIN5的中日数**: 0日
- **WIN5評価対象日数**: 0日

**注意**: WIN5フラグは存在するが、評価対象日（WIN5フラグ1～5が揃った日）が0日のため、WIN5評価は実行されていません。

### 順位誤差
- **平均順位誤差**: 1,296.30（詳細は要確認）

## 特徴量重要度（上位）

1. `prev_1_course_type`: 7,006.82
2. `horse_weight`: 2,267.94
3. `horse_number`: 1,303.10
4. `prev_2_course_type`: 1,110.46
5. `prize_2`: 1,012.10
6. `day`: 958.43
7. `age`: 469.75
8. `race_grade`: 316.88
9. `trainer_id`: 316.88
10. `prev_3_course_type`: 298.47

## 考察

### 良い点
- **3着内的中率が54.57%**: 半数以上のレースで3着内を的中
- **NDCG@1が0.4072**: 予測順位と実際の着順の一致度が比較的高い
- **特徴量重要度**: 前走データ（`prev_1_course_type`）が最も重要

### 改善の余地
- **1着的中率が25.38%**: 1着予測の精度向上が必要
- **回収率が78.36%**: 単勝回収率が100%を下回っている（-21.64%）
- **WIN5評価が実行されていない**: WIN5フラグ1～5が揃った日が存在しない可能性

### 次のステップ
1. **特徴量の追加**: より強力な特徴量を追加して的中率を向上
2. **モデルの改善**: アンサンブル学習や深層学習の検討
3. **WIN5データの確認**: WIN5フラグ1～5が揃った日が存在するか確認
4. **回収率の改善**: オッズを考慮した予測戦略の検討

