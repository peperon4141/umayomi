# 年度パックのみでの分析可能性

## 年度パックがあるデータタイプ

### ✅ 年度パックあり（10件）

1. **KYI, KYH, KYG** - 競走馬データ
2. **BAC, BAB** - 番組データ
3. **HJC** - 払戻情報データ
4. **SED, SEC** - 成績データ
5. **UKC** - 馬基本データ
6. **TYB** - 直前情報データ

## 予測モデルで必要なデータ

### 現在の特徴量（Features.py）

- `jockey_id` - 騎手ID
- `trainer_id` - 調教師ID
- `prev_1_*`, `prev_2_*` - 前走データ（過去1走、2走の成績）

### その他の特徴量

- レース情報（距離、コース、馬場状態、天候など）
- 馬の基本情報（性別、年齢、血統など）
- 直前情報（体重、増減など）

## 年度パックのみで取得可能なデータ

### ✅ 取得可能

1. **レース情報**: BAC/BAB（番組データ）
2. **馬の基本情報**: UKC（馬基本データ）
3. **競走馬データ**: KYI/KYH/KYG（競走馬データ）
4. **直前情報**: TYB（直前情報データ）
5. **過去の成績データ**: SED/SEC（成績データ）
   - **前走データの代替**: SED/SECから前走データを抽出可能
   - 成績データにはオッズ情報も含まれる（確定単勝オッズ、確定複勝オッズ）
6. **払戻情報**: HJC（払戻情報データ）

### ❌ 取得不可能（年度パックなし）

1. **KKA** - 競走馬拡張データ（オプション）
2. **OZ, OW, OU, OT, OV** - 詳細オッズデータ（検証用のみ）
3. **HJB** - 払戻情報データ（HJCで代替可能）
4. **ZED, ZEC** - 前走データ（SED/SECから抽出可能）
5. **JOA** - 情報データ（オプション）

### ✅ 取得可能（マスター系データ）

6. **KZA, CZA** - 騎手・調教師データ（**全騎手分・全調教師分**）
   - **年度パック**: なし（週単位更新のため）
   - **特徴**: 最新の週のデータに**すべての騎手・調教師のデータが含まれている**
   - **取得方法**: 最新の週のデータを1回取得すれば、すべてのデータが取得可能
   - **更新タイミング**: 木曜日19:00頃
   - **予測モデルでの使用**: `jockey_id`, `trainer_id`として使用
   - **問題なし**: マスター系データのため、過去データの一括取得は不要

7. **KSA, CSA** - 騎手・調教師データ（**今週出走分**）
   - **年度パック**: なし（週単位更新のため）
   - **特徴**: 今週出走分と先週成績更新分が含まれている
   - **取得方法**: 週単位で取得（最新の週のデータで十分）
   - **更新タイミング**: 木曜日19:00頃
   - **予測モデルでの使用**: `jockey_id`, `trainer_id`として使用
   - **問題なし**: マスター系データのため、過去データの一括取得は不要

## 問題点（修正）

### 騎手・調教師データ（KZA/KSA/CZA/CSA）

- **年度パック**: なし（週単位更新のため）
- **予測モデルでの使用**: `jockey_id`, `trainer_id`として使用
- **解決済み**: 
  - **KZA（全騎手分）**: 最新の週のデータにすべての騎手のデータが含まれている
  - **CZA（全調教師分）**: 最新の週のデータにすべての調教師のデータが含まれている
  - **KSA（今週出走分）**: 今週出走分と先週成績更新分が含まれている
  - **CSA（今週出走分）**: 今週出走分と先週成績更新分が含まれている
  - **マスター系データのため、過去データの一括取得は不要**

## 年度パック内のデータで取得可能な情報

### ✅ 予測モデルに必要な全データが取得可能

1. **レース情報**: BAC/BAB（番組データ）
   - 距離、コース、馬場状態、天候、賞金など

2. **馬の基本情報**: UKC（馬基本データ）
   - 性別、年齢、血統情報など

3. **競走馬データ**: KYI/KYH/KYG（競走馬データ）
   - IDM、各指数、騎手名、調教師名、前走キーなど
   - **重要**: `騎手名`、`調教師名`が含まれている（IDとして使用可能）

4. **直前情報**: TYB（直前情報データ）
   - 出走直前の馬の状態、体重、増減など
   - **重要**: `騎手コード`、`騎手名`が含まれている

5. **過去成績データ**: SED/SEC（成績データ）
   - **前走データの代替**: 成績データから前走データを抽出可能
   - **重要**: `騎手コード`、`調教師コード`が含まれている
   - **重要**: `確定単勝オッズ`、`確定複勝オッズ`が含まれている（基本オッズ情報）

6. **払戻情報**: HJC（払戻情報データ）
   - レース結果、払戻金など

## 結論

### ✅ **年度パック内の情報だけで分析可能**

**理由**:

1. **前走データ**: 成績データ（SED/SEC）から抽出可能
   - フォーマットが同じ
   - 年度パックがあるため、過去データの一括取得が容易

2. **騎手ID・調教師ID**: 複数のデータタイプに含まれている
   - 成績データ（SED/SEC）: `騎手コード`、`調教師コード`
   - 競走馬データ（KYI/KYH/KYG）: `騎手名`、`調教師名`
   - 直前情報（TYB）: `騎手コード`、`騎手名`
   - 年度パックがあるため、過去データの一括取得が容易

3. **基本オッズ情報**: 成績データ（SED/SEC）に含まれている
   - 確定単勝オッズ、確定複勝オッズ
   - 年度パックがあるため、過去データの一括取得が容易

4. **騎手・調教師データ**: マスター系データのため、最新の週のデータで十分
   - **KZA（全騎手分）**: 最新の週のデータにすべての騎手のデータが含まれている
   - **CZA（全調教師分）**: 最新の週のデータにすべての調教師のデータが含まれている
   - **KSA（今週出走分）**: 今週出走分と先週成績更新分が含まれている
   - **CSA（今週出走分）**: 今週出走分と先週成績更新分が含まれている
   - **年度パックは不要**: マスター系データのため、過去データの一括取得は不要

## まとめ

**年度パック内の情報だけで分析は完全に可能**です。

- ✅ 前走データ: 成績データから抽出可能（年度パックあり）
- ✅ 騎手ID・調教師ID: 成績データに含まれている（年度パックあり）
- ✅ 基本オッズ情報: 成績データに含まれている（年度パックあり）
- ✅ レース情報、馬の基本情報、競走馬データ、直前情報: すべて年度パックあり
- ✅ 騎手・調教師データ: マスター系データのため、最新の週のデータで十分（年度パック不要）

**年度パックなしのデータタイプ**:
- オッズデータ（OZ/OW/OU/OT/OV）: 検証用のみ（予測には不要）
- 騎手・調教師データ（KZA/KSA/CZA/CSA）: マスター系データのため、最新の週のデータで十分（年度パック不要）

