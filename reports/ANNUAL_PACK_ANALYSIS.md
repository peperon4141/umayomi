# 年度パックなしデータタイプの必要性分析

## 概要

年度パックが提供されていないデータタイプについて、予測モデルでの使用状況と必要性を分析します。

## 年度パックなしデータタイプ一覧

1. **KKA** - 競走馬拡張データ
2. **OZ, OW, OU, OT, OV** - オッズデータ（すべて）
3. **HJB** - 払戻情報データ
4. **ZED, ZEC** - 前走データ
5. **JOA** - 情報データ
6. **KZA, KSA, CZA, CSA** - 騎手・調教師データ

## 予測モデルでの使用状況

### 現在の特徴量（Features.py）

予測モデルで使用されている特徴量：
- `jockey_id` - 騎手ID
- `trainer_id` - 調教師ID
- `prev_1_*`, `prev_2_*` - 前走データ（過去1走、2走の成績）

## 必要性評価

### ✅ **必要（単体データで取得）**

#### 1. **ZED, ZEC (前走データ)**
- **必要性**: 🔴 **高**
- **理由**: 
  - 予測モデルで`prev_1_*`, `prev_2_*`として使用されている
  - 過去5走の成績データは予測に必須
- **取得方法**: 単体データを日付単位で取得（年度パックなし）
- **更新タイミング**: 金土 19:00

#### 2. **KZA, KSA, CZA, CSA (騎手・調教師データ)**
- **必要性**: 🔴 **高**
- **理由**: 
  - 予測モデルで`jockey_id`, `trainer_id`として使用されている
  - 騎手・調教師の成績データは予測に重要
- **取得方法**: 週単位で更新されるため、単体データを取得
  - **KZA（全騎手分）**: 最新の週のデータにすべての騎手のデータが含まれている
  - **CZA（全調教師分）**: 最新の週のデータにすべての調教師のデータが含まれている
  - **KSA（今週出走分）**: 今週出走分と先週成績更新分が含まれている
  - **CSA（今週出走分）**: 今週出走分と先週成績更新分が含まれている
- **更新タイミング**: 木 19:00
- **注意**: マスター系データのため、年度パックは不要。最新の週のデータを1回取得すれば、すべてのデータが取得可能

### ⚠️ **オプション（精度向上に使える可能性）**

#### 3. **KKA (競走馬拡張データ)**
- **必要性**: 🟡 **中**
- **理由**: 
  - 予測モデルでは直接使用されていない
  - より詳細な馬の状態分析に使える可能性
- **取得方法**: 単体データを日付単位で取得
- **更新タイミング**: 金土 19:00

#### 4. **JOA (情報データ)**
- **必要性**: 🟡 **中**
- **理由**: 
  - 予測モデルでは直接使用されていない
  - 情報からの詳細データによる予想精度向上の可能性
- **取得方法**: 単体データを日付単位で取得
- **更新タイミング**: 金土 19:00

### ❌ **不要（予測には不要、検証用のみ）**

#### 5. **OZ, OW, OU, OT, OV (オッズデータ)**
- **必要性**: ⚪ **低（予測には不要）**
- **理由**: 
  - 予測時点では利用できない（レース前のデータ）
  - 検証・分析用のみ
  - 予測モデルでは使用されていない
- **用途**: 予想精度の検証、市場との比較分析
- **取得方法**: 検証時のみ取得

#### 6. **HJB (払戻情報データ)**
- **必要性**: ⚪ **低（予測には不要）**
- **理由**: 
  - レース後のデータ
  - 予測には不要、検証用のみ
- **用途**: 結果の検証、予想精度の評価
- **取得方法**: 検証時のみ取得

## 推奨事項

### フェーズ1: 基本予想モデル（必須）

1. **ZED/ZEC**: 前走データ（単体データで取得）
   - 予測モデルで必須の特徴量
   - 日付単位で取得が必要

2. **KZA/KSA, CZA/CSA**: 騎手・調教師データ（単体データで取得）
   - 予測モデルで必須の特徴量
   - 週単位で取得が必要

### フェーズ2: 精度向上（オプション）

3. **KKA**: 競走馬拡張データ（単体データで取得）
   - より詳細な分析に使用可能

4. **JOA**: 情報データ（単体データで取得）
   - 予想精度向上の可能性

### フェーズ3: 検証・分析（不要）

5. **OZ, OW, OU, OT, OV**: オッズデータ
   - 予測には不要、検証時のみ取得

6. **HJB**: 払戻情報データ
   - 予測には不要、検証時のみ取得

## 結論

**年度パックなしでも必要なデータタイプ:**
- ✅ **ZED, ZEC** (前走データ) - 必須（ただし、SED/SECから抽出可能）
- ✅ **KZA, KSA, CZA, CSA** (騎手・調教師データ) - 必須
  - **KZA（全騎手分）**: マスター系データのため、最新の週のデータで十分（年度パック不要）
  - **CZA（全調教師分）**: マスター系データのため、最新の週のデータで十分（年度パック不要）
  - **KSA/CSA（今週出走分）**: 週単位で取得（最新の週のデータで十分）

**年度パックなしでオプションのデータタイプ:**
- ⚠️ **KKA** (競走馬拡張データ) - オプション
- ⚠️ **JOA** (情報データ) - オプション

**年度パックなしで不要なデータタイプ:**
- ❌ **OZ, OW, OU, OT, OV** (オッズデータ) - 予測には不要
- ❌ **HJB** (払戻情報データ) - 予測には不要

## 実装方針

1. **必須データ**: ZED/ZEC, KZA/KSA, CZA/CSAは単体データで取得する仕組みを実装
2. **オプションデータ**: KKA, JOAは必要に応じて取得
3. **検証データ**: OZ/OW/OU/OT/OV, HJBは検証時のみ取得

