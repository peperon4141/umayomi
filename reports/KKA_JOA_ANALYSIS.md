# KKA・JOAデータ分析

## KKA（競走馬拡張データ）でしか取得できない情報

### 概要
KKAはKYI/KYH/KYG（競走馬データ）の拡張版で、**競走馬の詳細な成績統計情報**を含むデータタイプです。

### KKAでしか取得できない情報

#### 1. **着度数統計**
- `JRA成績`: JRA競走での成績（1着数、2着数、3着数、着外数）
- `交流成績`: JRA所属馬のJRA認定地方交流競走、海外競走での成績
- `他成績`: 地方競馬、海外等の成績

#### 2. **競走馬該当条件別着度数集計**
- `芝ダ障害別成績`: 芝・ダート・障害別の成績
- `芝ダ障害別距離成績`: 芝・ダート・障害別の距離別成績
- `トラック距離成績`: トラック・距離別の成績
- `ローテ成績`: ローテーション別の成績
- `回り成績`: 回り（右回り・左回り）別の成績
- `騎手成績`: 騎手別の成績
- `良成績`: 良馬場での成績（芝・ダート・障害別）
- `稍成績`: 稍重馬場での成績（芝・ダート・障害別）
- `重成績`: 重馬場での成績（芝・ダート・障害別、不良含む）
- `Sペース成績`: スローペースでの成績
- `Mペース成績`: ミドルペースでの成績
- `Hペース成績`: ハイペースでの成績
- `季節成績`: 季節別の成績（春・夏・秋・冬）
- `枠成績`: 枠別の成績（内・中・外）

#### 3. **該当条件別着度数**
- `騎手距離成績`: 騎手・距離別の成績
- `騎手トラック距離成績`: 騎手・トラック・距離別の成績
- `騎手調教師別成績`: 騎手・調教師別の成績
- `騎手馬主別成績`: 騎手・馬主別の成績
- `騎手ブリンカ成績`: 騎手・ブリンカー別の成績
- `調教師馬主別成績`: 調教師・馬主別の成績

#### 4. **血統統計情報**
- `父馬産駒芝連対率`: 父馬の産駒の芝コースでの連対率（単位：%）
- `父馬産駒ダ連対率`: 父馬の産駒のダートコースでの連対率（単位：%）
- `父馬産駒連対平均距離`: 父馬の産駒の連対平均距離
- `母父馬産駒芝連対率`: 母父馬の産駒の芝コースでの連対率（単位：%）
- `母父馬産駒ダ連対率`: 母父馬の産駒のダートコースでの連対率（単位：%）
- `母父馬産駒連対平均距離`: 母父馬の産駒の連対平均距離

### 特徴
- **レコード長**: 324バイト
- **フィールド数**: 基本情報（場コード、年、回、日、R、馬番）＋ 詳細な成績統計情報
- **年度パック**: なし（日付単位で取得が必要）
- **更新頻度**: 金曜日19:00頃、土曜日20:00頃
- **データ集計期間**: 3～5年、月一回程度更新（該当条件別着度数）

### 他のデータタイプとの比較

| 情報 | KYI/KYH/KYG | KKA | UKC | SED/SEC |
|------|-------------|-----|-----|---------|
| 父馬名 | ❌ | ❌ | ✅ | ❌ |
| 母馬名 | ❌ | ❌ | ✅ | ❌ |
| 母父馬名 | ❌ | ❌ | ✅ | ❌ |
| 着度数統計 | ❌ | ✅ | ❌ | ❌ |
| 条件別成績統計 | ❌ | ✅ | ❌ | ❌ |
| 血統統計情報 | ❌ | ✅ | ❌ | ❌ |
| 前走データ | ❌ | ❌ | ❌ | ✅ |

### 分析への影響

#### ✅ 詳細な成績分析に有用
- **着度数統計**: JRA成績、交流成績、他成績の集計
- **条件別成績**: 芝・ダート・障害別、距離別、トラック別、ペース別、季節別などの詳細な成績統計
- **血統統計**: 父馬・母父馬の産駒の成績統計から、血統の傾向を分析可能
- **騎手・調教師別成績**: 特定の騎手・調教師との組み合わせでの成績統計

#### ⚠️ 予測モデルでの必要性
- 現在の予測モデルでは直接使用されていない
- ただし、条件別成績統計を特徴量として追加することで、予測精度向上の可能性がある
- 特に、ペース別成績、季節別成績、馬場状態別成績などは予測に有用な可能性がある

#### ⚠️ 注意点
- **フォーマット定義が不完全**: 現在の`kka.ts`には一部のフィールドしか定義されていない
- 実際のKKAデータには、仕様書に記載されているすべてのフィールドが含まれている
- 完全な解析には、フォーマット定義の更新が必要

---

## JOA（情報データ）に含まれる情報

### 概要
JOAは専門家の評価や指数、回収率などの**予想精度向上に役立つ情報**を含むデータタイプです。

### JOAに含まれる情報

#### 1. **基本情報**
- 場コード、年、回、R、日、馬番
- 血統登録番号、馬名

#### 2. **オッズ情報**
- `基準オッズ`: 基準オッズ
- `基準複勝オッズ`: 基準複勝オッズ

#### 3. **CID（調教・厩舎）指数**
- `CID調教素点`: CID調教素点
- `CID厩舎素点`: CID厩舎素点
- `CID素点`: CID素点
- `CID`: CID指数

#### 4. **LS指数**
- `LS指数`: LS指数
- `LS評価`: A, B, C のランクに分類

#### 5. **EM（消しフラグ）**
- `EM`: 1:消し、それ以外スペース

#### 6. **厩舎BB（ベストベット）情報**
- `厩舎ＢＢ印`: 厩舎BBの印（印コード参照）
- `厩舎ＢＢ◎単勝回収率`: 厩舎BBが該当する厩舎の馬に◎を付けた場合の単勝回収率
- `厩舎ＢＢ◎連対率`: 厩舎BBが該当する厩舎の馬に◎を付けた場合の連対率

#### 7. **騎手BB（ベストベット）情報**
- `騎手ＢＢ印`: 騎手BBの印
- `騎手ＢＢ◎単勝回収率`: 騎手BBが該当する騎手の馬に◎を付けた場合の単勝回収率
- `騎手ＢＢ◎連対率`: 騎手BBが該当する騎手の馬に◎を付けた場合の連対率

### 特徴
- **レコード長**: 116バイト（小さい）
- **年度パック**: なし（日付単位で取得が必要）
- **専門家の評価**: 厩舎BB、騎手BBなどの専門家評価が含まれる

### 他のデータタイプとの比較

| 情報 | KYI/KYH/KYG | JOA | TYB |
|------|-------------|-----|-----|
| 基準オッズ | ✅ | ✅ | ❌ |
| 基準複勝オッズ | ✅ | ✅ | ❌ |
| CID調教素点 | ❌ | ✅ | ❌ |
| CID厩舎素点 | ❌ | ✅ | ❌ |
| CID素点 | ❌ | ✅ | ❌ |
| CID | ❌ | ✅ | ❌ |
| LS指数 | ✅ | ✅ | ❌ |
| LS評価 | ❌ | ✅ | ❌ |
| 厩舎BB印 | ❌ | ✅ | ❌ |
| 厩舎BB◎単勝回収率 | ❌ | ✅ | ❌ |
| 厩舎BB◎連対率 | ❌ | ✅ | ❌ |
| 騎手BB印 | ❌ | ✅ | ❌ |
| 騎手BB◎単勝回収率 | ❌ | ✅ | ❌ |
| 騎手BB◎連対率 | ❌ | ✅ | ❌ |
| EM（消しフラグ） | ❌ | ✅ | ❌ |

### 分析への影響

#### ✅ 予想精度向上に有用
- **専門家の評価**: 厩舎BB、騎手BBの評価を活用可能
- **独自指数**: CID指数、LS指数などの独自指数を活用可能
- **回収率情報**: 専門家の評価精度を判断可能（BB◎単勝回収率、BB◎連対率）
- **消しフラグ**: EM（消しフラグ）で除外対象を識別可能

#### ⚠️ 予測モデルでの必要性
- 現在の予測モデルでは直接使用されていない
- ただし、専門家の評価（BB印、BB回収率）を特徴量として追加することで、予測精度向上の可能性がある
- CID指数、LS指数などの独自指数も予測に有用な可能性がある

---

## まとめ

### KKA（競走馬拡張データ）
- **独自情報**: 父馬・母父馬の産駒統計情報（連対率、平均距離）
- **用途**: 血統分析、血統による適性判断
- **必要性**: 血統統計が必要な場合のみ

### JOA（情報データ）
- **独自情報**: CID指数、LS指数、厩舎BB情報、騎手BB情報、EM（消しフラグ）
- **用途**: 専門家評価の活用、予想精度向上
- **必要性**: 専門家の評価を特徴量として使用する場合

### 年度パックとの関係
- **KKA**: 年度パックなし → 日付単位で取得が必要
- **JOA**: 年度パックなし → 日付単位で取得が必要

### 推奨事項
1. **基本分析**: 年度パック内の情報（KYI/KYH/KYG、UKCなど）で十分
2. **血統分析**: KKAが必要（ただし、UKCの血統情報でも基本的な分析は可能）
3. **予想精度向上**: JOAを追加することで、専門家評価を活用可能

